{"metadata":{"roleHeading":"Article","role":"article","title":"Encrypted Private Keys","modules":[{"name":"SwiftECC"}]},"abstract":[{"type":"text","text":"Private keys can be encrypted as described in [PKCS#5] using the PBES2 scheme"}],"primaryContentSections":[{"content":[{"text":"","level":2,"type":"heading","anchor":""},{"text":"Encrypt private Key","level":3,"type":"heading","anchor":"Encrypt-private-Key"},{"text":"Example","level":4,"type":"heading","anchor":"Example"},{"type":"codeListing","syntax":"swift","code":["let pw = Bytes(\"MySecret\".utf8)","let domain = Domain.instance(curve: .EC384r1)","let (_, priv) = domain.makeKeyPair()","let encryptedKey = priv.pemEncrypted(password: pw, cipher: .AES256)","print(encryptedKey)"]},{"type":"paragraph","inlineContent":[{"text":"giving (for example):","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["-----BEGIN ENCRYPTED PRIVATE KEY-----","MIIBHjBJBgkqhkiG9w0BBQ0wPDAbBgkqhkiG9w0BBQwwDgQI3id2VFlFxXUCAggAMB0GCWCGSAFl","AwQBKgQQlJJQtcZ23p1Q4fXmvpS6hgSB0DBuxL\/sCUc\/c9NDhrHK\/R2sbtS7rs5a9zUFwcMNV1nV","UCK1SSbaCg8\/BxHPfqKlAw4RcnsQtN+YD7hz5pxFYDcYk4mEZo7ODFkRxhKF7vLsUsRZAl2XYGIJ","flp03+fAWdsiNisjo\/4Y\/5xxWvCeOBzfjRpsDT4HjRgcxTtxrzvInzrJkQwyDBAkPMudIshkPOQ1","LEoXhi0gVFl9jGN+eSLv5Wba2chf\/kQcw7R4B3iiE5787wE2fWvvh4ek3oSYcLCvO\/gkwgUhyA2h","k3rn01k=","-----END ENCRYPTED PRIVATE KEY-----"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The implied encryption parameters are cipher block mode = CBC, iteration count = 2048 and salt = 8 random bytes."},{"type":"text","text":" "},{"type":"text","text":"The password is simply a byte array, any possible interpretation of it as a string is unspecified."},{"type":"text","text":" "},{"type":"text","text":"The encrypted private key is compatible with, and is readable by OpenSSL."}]},{"text":"Load encrypted Key","level":3,"type":"heading","anchor":"Load-encrypted-Key"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Private keys can be created from their PEM encodings in encrypted form."},{"type":"text","text":" "},{"type":"text","text":"In the example the encrypted private key was created by OpenSSL using the AES-256 cipher in CBC mode with password "},{"code":"abcd","type":"codeVoice"},{"type":"text","text":"."}]},{"text":"Example","level":4,"type":"heading","anchor":"Example"},{"type":"codeListing","syntax":"swift","code":["let encryptedPem =","\"\"\"","-----BEGIN ENCRYPTED PRIVATE KEY-----","MIHeMEkGCSqGSIb3DQEFDTA8MBsGCSqGSIb3DQEFDDAOBAg7pgGVDlE\/xgICCAAwHQYJYIZIAWUD","BAEqBBCFF4KWxWqhOB5Q8dOwdcPkBIGQbuj2TvlhtpMZ3ZhLBBBxkJfY1l09yNcJNEcvS8RX4\/ST","XZkt5gMBgtY2DvGAKI0wkpbim+kXSjM6\/hmNxY5bjhQapm8l8jbVGkETtYfseZXpvIT5lnBy9KtO","8o3OmlRTV3xXu3KeDZakDoimfQ8GN7SldmFRcz171yMoIQ17ZU95uneZoogsRuMVMVUJXEh7","-----END ENCRYPTED PRIVATE KEY-----","\"\"\"","let privKey = try ECPrivateKey(pem: encryptedPem, password: Bytes(\"abcd\".utf8))","print(privKey)"]},{"inlineContent":[{"type":"text","text":"giving:"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["Sequence (4):","  Integer: 1","  Octet String (32): 1e 4d c5 de 0f 47 66 6b 7e 4c b8 ee e5 0f f9 6c 4a d3 4f 6f 2e 07 f7 fc e7 c8 24 dd 17 18 fd fa","  [0]:","    Object Identifier: 1.2.840.10045.3.1.7","  [1]:","    Bit String (520): 00000100 00101110 10100100 10110110 10001111 11111010 00111111 00000111 01011010 01011101 01110000 01100001 10110000 10101110 01011010 10011100 10001111 00110100 11010000 11111101 10010110 11001110 00101011 10001111 11000001 10101001 11000000 00001101 00011101 11011101 11001011 10101110 10011000 11001011 10000101 01110001 10100010 11100000 01100011 01101010 11110100 11011101 00011000 01011101 10010110 01010101 10110011 00101101 01010000 10100010 00110001 10000100 11011001 00111001 00011000 01100100 10001110 11011111 10011100 00010100 10110101 11011010 00111010 10101100 11111100"]},{"inlineContent":[{"type":"text","text":"SwiftECC can read encrypted private key files provided they were encrypted with one of the ciphers AES-128, AES-192 or AES-256 in CBC mode."}],"type":"paragraph"}],"kind":"content"}],"sections":[],"kind":"article","variants":[{"paths":["\/documentation\/swiftecc\/encryptedkeys"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/EncryptedKeys"},"schemaVersion":{"patch":0,"minor":3,"major":0},"hierarchy":{"paths":[["doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC"]]},"seeAlsoSections":[{"generated":true,"title":"Articles","identifiers":["doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/KeyManagement","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/EncryptDecrypt","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/AEADEncryptDecrypt","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/SignVerify","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/KeyAgrement","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/CreateDomain","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/ECArithmetic","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/Performance","doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/References"],"anchor":"Articles"}],"references":{"doc://swiftecc.SwiftECC/documentation/SwiftECC/ECArithmetic":{"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/ECArithmetic","abstract":[{"text":"SwiftECC implements the common elliptic curve arithmetic operations","type":"text"}],"kind":"article","type":"topic","title":"Elliptic Curve Arithmetic","url":"\/documentation\/swiftecc\/ecarithmetic","role":"article"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/EncryptDecrypt":{"role":"article","kind":"article","type":"topic","abstract":[{"text":"ECIES encryption and decryption","type":"text"}],"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/EncryptDecrypt","url":"\/documentation\/swiftecc\/encryptdecrypt","title":"Encrypt and Decrypt"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/References":{"role":"article","kind":"article","type":"topic","abstract":[{"text":"Algorithms from the following books and papers have been used in the implementation","type":"text"}],"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/References","url":"\/documentation\/swiftecc\/references","title":"References"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/Performance":{"role":"article","kind":"article","type":"topic","abstract":[{"text":"Execution times for certain SwiftECC operations","type":"text"}],"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/Performance","url":"\/documentation\/swiftecc\/performance","title":"Performance"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/SignVerify":{"type":"topic","role":"article","title":"Sign and Verify","identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/SignVerify","kind":"article","abstract":[{"text":"Signing data and verifying signatures","type":"text"}],"url":"\/documentation\/swiftecc\/signverify"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/KeyManagement":{"url":"\/documentation\/swiftecc\/keymanagement","title":"Key Management","identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/KeyManagement","type":"topic","abstract":[{"type":"text","text":"Creating new keys and loading exsisting keys"}],"kind":"article","role":"article"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/AEADEncryptDecrypt":{"url":"\/documentation\/swiftecc\/aeadencryptdecrypt","identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/AEADEncryptDecrypt","title":"AEAD Encrypt and Decrypt","type":"topic","abstract":[{"type":"text","text":"Authenticated Encryption with Associated Data"}],"kind":"article","role":"article"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/KeyAgrement":{"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/KeyAgrement","title":"Secret Key Agreement","type":"topic","kind":"article","role":"article","url":"\/documentation\/swiftecc\/keyagrement","abstract":[{"type":"text","text":"Generating a shared secret"}]},"doc://swiftecc.SwiftECC/documentation/SwiftECC":{"type":"topic","abstract":[{"type":"text","text":"Elliptic Curve Cryptography"}],"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC","kind":"symbol","title":"SwiftECC","url":"\/documentation\/swiftecc","role":"collection"},"doc://swiftecc.SwiftECC/documentation/SwiftECC/CreateDomain":{"identifier":"doc:\/\/swiftecc.SwiftECC\/documentation\/SwiftECC\/CreateDomain","title":"Create new Domains","type":"topic","kind":"article","role":"article","url":"\/documentation\/swiftecc\/createdomain","abstract":[{"text":"You can create your own domains as illustrated by two examples","type":"text"}]}}}